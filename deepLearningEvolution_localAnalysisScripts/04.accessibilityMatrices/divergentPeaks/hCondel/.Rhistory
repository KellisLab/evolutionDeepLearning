library(ggplot2)
data <- read.csv("rawMpraResults.txt", header=TRUE, sep="\t")
head(data)
library(ggpubr)
colnames(data)
ggscatter(data, "log2FoldChange_Skew_K562", "padj_Skew_K562")
data$minusLog10pAdjSkewK562 <- -log10(data$padj_Skew_K562)
ggscatter(data, "log2FoldChange_Skew_K562", "minusLog10pAdjSkewK562")
sum(data$padj_Skew_K562 < 0.01)
count(data$padj_Skew_K562 < 0.01)
sum(data$padj_Skew_K562 < 0.01)
data$padj_Skew_K562
data$padj_Skew_K562 < 0.01
sum(data$padj_Skew_K562 < 0.01)
sum(data$padj_Skew_K562 < 0.01, na.rm=TRUE)
sum(data$padj_Skew_K562 < 0.01 & data$log2FoldChange_Skew_K562 > 0, na.rm=TRUE)
sum(data$padj_Skew_K562 < 0.01 & data$log2FoldChange_Skew_K562 < 0, na.rm=TRUE)
sum(data$padj_Skew_K562 < 0.01 |
data$padj_Skew_GM12878 < 0.01 |
data$padj_Skew_HEK293 < 0.01 |
data$padj_Skew_NPC < 0.01 |
data$padj_Skew_SKNSH < 0.01)
sum(data$padj_Skew_K562 < 0.01 |
data$padj_Skew_GM12878 < 0.01 |
data$padj_Skew_HEK293 < 0.01 |
data$padj_Skew_NPC < 0.01 |
data$padj_Skew_SKNSH < 0.01, na.rm=TRUE)
sum(data$padj_Skew_K562 < 0.01 |
data$padj_Skew_GM12878 < 0.01 |
data$padj_Skew_HEK293 < 0.01 |
data$padj_Skew_NPC < 0.01 |
data$padj_Skew_SKNSH < 0.01 | data$padj_Skew_HEPG2 < 0.01, na.rm=TRUE)
sum(data$padj_Skew_K562 < 0.05 |
data$padj_Skew_GM12878 < 0.05 |
data$padj_Skew_HEK293 < 0.05 |
data$padj_Skew_NPC < 0.05 |
data$padj_Skew_SKNSH < 0.05 | data$padj_Skew_HEPG2 < 0.05, na.rm=TRUE)
colnames(data)
passing_threshold <- (
(data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1)) |
(data$padj_Skew_GM12878 < 0.05 & (data$padj_Human_GM12878 < 0.1 | data$padj_Chimp_GM12878 < 0.1)) |
(data$padj_Skew_HEK293 < 0.05 & (data$padj_Human_HEK293 < 0.1 | data$padj_Chimp_HEK293 < 0.1)) |
(data$padj_Skew_NPC < 0.05 & (data$padj_Human_NPC < 0.1 | data$padj_Chimp_NPC < 0.1)) |
(data$padj_Skew_SKNSH < 0.05 & (data$padj_Human_SKNSH < 0.1 | data$padj_Chimp_SKNSH < 0.1)) |
(data$padj_Skew_HEPG2 < 0.05 & (data$padj_Human_HEPG2 < 0.1 | data$padj_Chimp_HEPG2 < 0.1))
)
# Count how many rows pass the threshold
count_passing <- sum(passing_threshold, na.rm = TRUE)
count_passing
sum(data$padj_Skew_K562 < 0.05 |
data$padj_Skew_GM12878 < 0.05 |
data$padj_Skew_HEK293 < 0.05 |
data$padj_Skew_NPC < 0.05 |
data$padj_Skew_SKNSH < 0.05 | data$padj_Skew_HEPG2 < 0.05, na.rm=TRUE)
upK562 <- data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 > 0
dim(upK562)
upK562 <- data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 > 0
data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 > 0
upK562 <- subset(data, data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 > 0)
dim(upK562)
upK562
length(upK562)
upK562 <- subset(data, data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 > 0)
downK562 <- subset(data, data$padj_Skew_K562 < 0.05 & (data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) & data$log2FoldChange_Skew_K562 < 0)
dim(downK562)
metadata <- read.csv("metadata.txt", header=TRUE, sep="\t")
head(metadata)
metadata <- select(metadata, c("hCONDEL_ID", "hg38_mpra_chr", "hg38_mpra_start_pos", "hg38_mpra_end_pos"))
library(dplyr)
metadata <- select(metadata, c("hCONDEL_ID", "hg38_mpra_chr", "hg38_mpra_start_pos", "hg38_mpra_end_pos"))
head(metadata)
head(data)
merged_data <- merge(data, metadata, by="hCONDEL_ID")
head(merged_data)
data$minusLog10pAdjSkewK562 <- -log10(data$padj_Skew_K562)
sum(data$padj_Skew_K562 < 0.05 |
data$padj_Skew_GM12878 < 0.05 |
data$padj_Skew_HEK293 < 0.05 |
data$padj_Skew_NPC < 0.05 |
data$padj_Skew_SKNSH < 0.05 | data$padj_Skew_HEPG2 < 0.05, na.rm=TRUE)
ggscatter(data, "log2FoldChange_Skew_K562", "minusLog10pAdjSkewK562")
# K562
upK562 <- subset(data, data$padj_Skew_K562 < 0.05 &
(data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) &
data$log2FoldChange_Skew_K562 > 0)
downK562 <- subset(data, data$padj_Skew_K562 < 0.05 &
(data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) &
data$log2FoldChange_Skew_K562 < 0)
# GM12878
upGM12878 <- subset(data, data$padj_Skew_GM12878 < 0.05 &
(data$padj_Human_GM12878 < 0.1 | data$padj_Chimp_GM12878 < 0.1) &
data$log2FoldChange_Skew_GM12878 > 0)
downGM12878 <- subset(data, data$padj_Skew_GM12878 < 0.05 &
(data$padj_Human_GM12878 < 0.1 | data$padj_Chimp_GM12878 < 0.1) &
data$log2FoldChange_Skew_GM12878 < 0)
# HEK293
upHEK293 <- subset(data, data$padj_Skew_HEK293 < 0.05 &
(data$padj_Human_HEK293 < 0.1 | data$padj_Chimp_HEK293 < 0.1) &
data$log2FoldChange_Skew_HEK293 > 0)
downHEK293 <- subset(data, data$padj_Skew_HEK293 < 0.05 &
(data$padj_Human_HEK293 < 0.1 | data$padj_Chimp_HEK293 < 0.1) &
data$log2FoldChange_Skew_HEK293 < 0)
# NPC
upNPC <- subset(data, data$padj_Skew_NPC < 0.05 &
(data$padj_Human_NPC < 0.1 | data$padj_Chimp_NPC < 0.1) &
data$log2FoldChange_Skew_NPC > 0)
downNPC <- subset(data, data$padj_Skew_NPC < 0.05 &
(data$padj_Human_NPC < 0.1 | data$padj_Chimp_NPC < 0.1) &
data$log2FoldChange_Skew_NPC < 0)
# SKNSH
upSKNSH <- subset(data, data$padj_Skew_SKNSH < 0.05 &
(data$padj_Human_SKNSH < 0.1 | data$padj_Chimp_SKNSH < 0.1) &
data$log2FoldChange_Skew_SKNSH > 0)
downSKNSH <- subset(data, data$padj_Skew_SKNSH < 0.05 &
(data$padj_Human_SKNSH < 0.1 | data$padj_Chimp_SKNSH < 0.1) &
data$log2FoldChange_Skew_SKNSH < 0)
# HEPG2
upHEPG2 <- subset(data, data$padj_Skew_HEPG2 < 0.05 &
(data$padj_Human_HEPG2 < 0.1 | data$padj_Chimp_HEPG2 < 0.1) &
data$log2FoldChange_Skew_HEPG2 > 0)
downHEPG2 <- subset(data, data$padj_Skew_HEPG2 < 0.05 &
(data$padj_Human_HEPG2 < 0.1 | data$padj_Chimp_HEPG2 < 0.1) &
data$log2FoldChange_Skew_HEPG2 < 0)
head(downHEPG2)
data <- merge(data, metadata, by="hCONDEL_ID")
data$minusLog10pAdjSkewK562 <- -log10(data$padj_Skew_K562)
sum(data$padj_Skew_K562 < 0.05 |
data$padj_Skew_GM12878 < 0.05 |
data$padj_Skew_HEK293 < 0.05 |
data$padj_Skew_NPC < 0.05 |
data$padj_Skew_SKNSH < 0.05 | data$padj_Skew_HEPG2 < 0.05, na.rm=TRUE)
ggscatter(data, "log2FoldChange_Skew_K562", "minusLog10pAdjSkewK562")
# K562
upK562 <- subset(data, data$padj_Skew_K562 < 0.05 &
(data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) &
data$log2FoldChange_Skew_K562 > 0)
downK562 <- subset(data, data$padj_Skew_K562 < 0.05 &
(data$padj_Human_K562 < 0.1 | data$padj_Chimp_K562 < 0.1) &
data$log2FoldChange_Skew_K562 < 0)
# GM12878
upGM12878 <- subset(data, data$padj_Skew_GM12878 < 0.05 &
(data$padj_Human_GM12878 < 0.1 | data$padj_Chimp_GM12878 < 0.1) &
data$log2FoldChange_Skew_GM12878 > 0)
downGM12878 <- subset(data, data$padj_Skew_GM12878 < 0.05 &
(data$padj_Human_GM12878 < 0.1 | data$padj_Chimp_GM12878 < 0.1) &
data$log2FoldChange_Skew_GM12878 < 0)
# HEK293
upHEK293 <- subset(data, data$padj_Skew_HEK293 < 0.05 &
(data$padj_Human_HEK293 < 0.1 | data$padj_Chimp_HEK293 < 0.1) &
data$log2FoldChange_Skew_HEK293 > 0)
downHEK293 <- subset(data, data$padj_Skew_HEK293 < 0.05 &
(data$padj_Human_HEK293 < 0.1 | data$padj_Chimp_HEK293 < 0.1) &
data$log2FoldChange_Skew_HEK293 < 0)
# NPC
upNPC <- subset(data, data$padj_Skew_NPC < 0.05 &
(data$padj_Human_NPC < 0.1 | data$padj_Chimp_NPC < 0.1) &
data$log2FoldChange_Skew_NPC > 0)
downNPC <- subset(data, data$padj_Skew_NPC < 0.05 &
(data$padj_Human_NPC < 0.1 | data$padj_Chimp_NPC < 0.1) &
data$log2FoldChange_Skew_NPC < 0)
# SKNSH
upSKNSH <- subset(data, data$padj_Skew_SKNSH < 0.05 &
(data$padj_Human_SKNSH < 0.1 | data$padj_Chimp_SKNSH < 0.1) &
data$log2FoldChange_Skew_SKNSH > 0)
downSKNSH <- subset(data, data$padj_Skew_SKNSH < 0.05 &
(data$padj_Human_SKNSH < 0.1 | data$padj_Chimp_SKNSH < 0.1) &
data$log2FoldChange_Skew_SKNSH < 0)
# HEPG2
upHEPG2 <- subset(data, data$padj_Skew_HEPG2 < 0.05 &
(data$padj_Human_HEPG2 < 0.1 | data$padj_Chimp_HEPG2 < 0.1) &
data$log2FoldChange_Skew_HEPG2 > 0)
downHEPG2 <- subset(data, data$padj_Skew_HEPG2 < 0.05 &
(data$padj_Human_HEPG2 < 0.1 | data$padj_Chimp_HEPG2 < 0.1) &
data$log2FoldChange_Skew_HEPG2 < 0)
head(downHEPG2)
writeBed <- function(data, filename, nameField) {
bed_data <- data.frame(
chr = data$hg38_mpra_chr,
start = data$hg38_mpra_start_pos,
end = data$hg38_mpra_end_pos,
name = nameField
)
write.table(bed_data, file = filename, quote = FALSE, sep = "\t", row.names = FALSE, col.names = FALSE)
}
writeBed(upK562, "subSets/upK562.bed", "upK562")
riteBed(upK562, "subSets/upK562.bed", "upK562")
writeBed(upK562, "subSets/upK562.bed", "upK562")
writeBed(downK562, "subSets/downK562.bed", "downK562")
writeBed(upGM12878, "subSets/upGM12878.bed", "upGM12878")
writeBed(downGM12878, "subSets/downGM12878.bed", "downGM12878")
writeBed(upHEK293, "subSets/upHEK293.bed", "upHEK293")
writeBed(downHEK293, "subSets/downHEK293.bed", "downHEK293")
writeBed(upNPC, "subSets/upNPC.bed", "upNPC")
writeBed(downNPC, "subSets/downNPC.bed", "downNPC")
writeBed(upSKNSH, "subSets/upSKNSH.bed", "upSKNSH")
writeBed(downSKNSH, "subSets/downSKNSH.bed", "downSKNSH")
writeBed(upHEPG2, "subSets/upHEPG2.bed", "upHEPG2")
writeBed(downHEPG2, "subSets/downHEPG2.bed", "downHEPG2")
